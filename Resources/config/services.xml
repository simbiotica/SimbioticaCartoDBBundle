<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

	<parameters>
	    <parameter key="cartodb_connection_private.class">Simbiotica\CartoDBBundle\CartoDB\PrivateConnection</parameter>
	    <parameter key="cartodb_connection_public.class">Simbiotica\CartoDBBundle\CartoDB\PublicConnection</parameter>
	    <parameter key="cartodb_connection_factory.class">Simbiotica\CartoDBBundle\CartoDB\ConnectionFactory</parameter>
	    <parameter key="cartodb.listener.cartodblink.class">Simbiotica\CartoDBBundle\CartoDBLink\CartoDBLinkListener</parameter>
	</parameters>
	
	<services>
	    <service id="cartodb_connection_factory" class="%cartodb_connection_factory.class%">
	       <argument type="service" id="session" />
	    </service>
	    
	    <service id="cartodb_connection_private"
	             class="%cartodb_connection_private.class%"
	             factory-service="cartodb_connection_factory"
	             factory-method="createPrivateConnection"
	    />
	    
	    <service id="cartodb_connection_public"
                 class="%cartodb_connection_public.class%"
                 factory-service="cartodb_connection_factory"
                 factory-method="createPublicConnection"
        />
        
        <service id="cartodb.listener.cartodblink" class="%cartodb.listener.cartodblink.class%" public="false">
            <argument type="service" id="service_container" />
            <call method="setAnnotationReader">
                <argument type="service" id="annotation_reader" />
            </call>
        </service>
	</services>
	
</container>